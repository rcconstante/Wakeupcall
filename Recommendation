FUNCTION generateRecommendations(data):

    recs = empty list


    ==============================================================
    =                  1. SINGLE-FACTOR RULES                    =
    ==============================================================

    -- Sleep Duration (CDC, AASM) --
    IF data.Sleep_Duration < 7 THEN
        Title: "Increase Your Total Sleep Time"
        Description: "You reported sleeping less than 7 hours per night. Adults typically need 7–9 hours of sleep. Gradually move your bedtime earlier by about 15 minutes every few days to reduce sleep debt."
        Source: "Centers for Disease Control and Prevention (CDC) – Sleep Duration Recommendations; American Academy of Sleep Medicine (AASM)."
    ENDIF

    IF data.Sleep_Duration >= 9 THEN
        Title: "Monitor Oversleeping and Sleep Quality"
        Description: "You reported sleeping 9 hours or more. Oversleeping can sometimes reflect poor sleep quality or fragmented sleep. Pay attention to how refreshed you feel during the day."
        Source: "American Academy of Sleep Medicine (AASM) – Sleep Quality Guidance."
    ENDIF


    -- Snoring (NSF, AASM) --
    IF data.Snoring == 1 THEN
        Title: "Manage Snoring and Airway Obstruction"
        Description: "You reported regular snoring, which can be a sign of partial airway obstruction during sleep. Side-sleeping, using a supportive pillow, and avoiding heavy meals close to bedtime may help reduce snoring."
        Source: "National Sleep Foundation – Snoring and Sleep; American Academy of Sleep Medicine (AASM) – Snoring and OSA."
    ENDIF


    -- Epworth Sleepiness Score (ESS ≥ 11) --
    IF data.Epworth_Score >= 11 THEN
        Title: "Address Excessive Daytime Sleepiness"
        Description: "Your Epworth Sleepiness Score is elevated, which suggests excessive daytime sleepiness. This often reflects poor sleep quality or fragmented sleep at night."
        Source: "Johns MW, Epworth Sleepiness Scale (1991); AASM – Daytime Sleepiness Guidance."
    ENDIF


    -- BMI (WHO + AASM) --
    IF data.BMI >= 30 THEN
        Title: "Consider Weight’s Impact on Breathing"
        Description: "Your BMI falls in a range that can increase narrowing of the upper airway during sleep. Even modest weight changes may help improve breathing and sleep quality over time."
        Source: "World Health Organization (WHO) – BMI Classification; AASM – Obesity and OSA Risk."
    ENDIF


    -- Neck Circumference (STOP-Bang) --
    IF data.Neck_Circumference >= 40 THEN
        Title: "Neck Size and Airway Narrowing"
        Description: "A neck circumference of 40 cm or more is associated with a higher chance of airway narrowing during sleep, which can contribute to snoring or sleep apnea."
        Source: "Chung F. et al., STOP-Bang Questionnaire Guidelines."
    ENDIF


    -- Hypertension (AHA + OSA) --
    IF data.Hypertension == 1 THEN
        Title: "Hypertension and Sleep-Disordered Breathing"
        Description: "You reported hypertension. High blood pressure is commonly linked with undiagnosed sleep-disordered breathing and may be worsened by poor sleep."
        Source: "American Heart Association (AHA) – OSA and Hypertension."
    ENDIF


    -- Diabetes (ADA + AASM) --
    IF data.Diabetes == 1 THEN
        Title: "Diabetes and Sleep Quality"
        Description: "You reported diabetes. Blood sugar imbalance is often associated with disrupted sleep patterns, and sleep apnea is more frequent among people with diabetes."
        Source: "American Diabetes Association (ADA); AASM – Sleep and Metabolic Health."
    ENDIF


    -- Alcohol Use (AASM) --
    IF data.Alcohol == 1 THEN
        Title: "Reduce Alcohol Intake Near Bedtime"
        Description: "Since you reported alcohol use, especially if taken in the evening, it can relax the upper airway muscles, worsen snoring, and increase breathing pauses during sleep. Try to avoid alcohol at least 3–4 hours before bed."
        Source: "American Academy of Sleep Medicine (AASM) – Alcohol and Sleep Quality."
    ENDIF


    -- STOP-Bang Total (Chung et al.) --
    IF data.STOPBANG_Total >= 5 THEN
        Title: "High STOP-Bang Score and OSA Risk"
        Description: "Your STOP-Bang score falls in a range associated with higher risk of obstructive sleep apnea. Monitoring your nighttime symptoms and daytime sleepiness is especially important."
        Source: "Chung F. et al., STOP-Bang Questionnaire Validation Studies."
    ENDIF


    -- Physical Activity Minutes (CDC, Harvard Sleep) --
    IF data.Physical_Activity_Minutes < 30 THEN
        Title: "Increase Daily Physical Activity"
        Description: "You reported less than 30 minutes of physical activity per day. Increasing daily movement to at least 30 minutes can help improve sleep quality, reduce sleep latency, and support overall health."
        Source: "CDC Physical Activity Guidelines; Harvard Medical School – Division of Sleep Medicine (Exercise and Sleep)."
    ENDIF

    IF data.Physical_Activity_Minutes >= 150 THEN
        Title: "You Meet Activity Recommendations"
        Description: "Your reported activity matches or exceeds commonly recommended weekly activity levels. Regular movement is associated with deeper sleep and better daytime energy."
        Source: "CDC Physical Activity Guidelines; Sleep Foundation – Exercise and Sleep Quality."
    ENDIF


    -- Activity Type (Light / Moderate / Vigorous) --
    IF data.Activity_Type == "light" THEN
        Title: "Light Activity and Sleep Support"
        Description: "You indicated mostly light activity. While light movement supports general health, adding some moderate-intensity exercise may have a stronger positive effect on sleep depth and quality."
        Source: "Sleep Foundation – Exercise Intensity and Sleep."
    ENDIF

    IF data.Activity_Type == "moderate" THEN
        Title: "Moderate Exercise and Deeper Sleep"
        Description: "Your activity level is in the moderate range. Regular moderate exercise is associated with improved deep sleep and reduced daytime fatigue."
        Source: "American Academy of Sleep Medicine (AASM) – Physical Activity and Sleep."
    ENDIF

    IF data.Activity_Type == "vigorous" THEN
        Title: "Timing Vigorous Exercise Wisely"
        Description: "You reported vigorous activity. Vigorous exercise can benefit sleep overall, but if done too close to bedtime, it may temporarily increase alertness and make it harder to fall asleep."
        Source: "National Sleep Foundation – Vigorous Exercise and Sleep Onset."
    ENDIF


    -- Activity Timing (Morning / Afternoon / Evening / Night) --
    IF data.Activity_Time == "morning" THEN
        Title: "Morning Exercise and Body Clock"
        Description: "You usually exercise in the morning. Morning activity can help strengthen your sleep-wake cycle and support easier sleep onset at night."
        Source: "Sleep Foundation – Morning Exercise and Circadian Rhythm."
    ENDIF

    IF data.Activity_Time == "afternoon" THEN
        Title: "Afternoon Movement and Stress Relief"
        Description: "You usually exercise in the afternoon. Exercise at this time can help relieve stress and stabilize energy, which can support more restful sleep later."
        Source: "American Academy of Sleep Medicine – Exercise Timing and Sleep."
    ENDIF

    IF data.Activity_Time == "evening" THEN
        Title: "Evening Exercise and Sleep Onset"
        Description: "You usually exercise in the evening. For many people, light to moderate evening exercise is still compatible with good sleep, but vigorous activity too close to bedtime may delay sleep onset."
        Source: "National Sleep Foundation – Evening Exercise and Sleep."
    ENDIF

    IF data.Activity_Time == "night" THEN
        Title: "Nighttime Activity and Alertness"
        Description: "You reported exercising at night. Intense activity late at night can raise heart rate and alertness, which may make it harder to fall asleep soon after."
        Source: "Harvard Medical School – Division of Sleep Medicine (Exercise Timing)."
    ENDIF



    ==============================================================
    =               2. TWO-FACTOR COMBINATION RULES              =
    ==============================================================

    -- Alcohol + Hypertension --
    IF data.Alcohol == 1 AND data.Hypertension == 1 THEN
        Title: "Alcohol and Hypertension During Sleep"
        Description: "Combining alcohol use with hypertension can increase cardiovascular strain and contribute to more unstable breathing during sleep. Reducing evening alcohol intake can be especially beneficial for blood pressure and sleep."
        Source: "American Academy of Sleep Medicine (AASM); American Heart Association (AHA)."
    ENDIF


    -- Snoring + Hypertension --
    IF data.Snoring == 1 AND data.Hypertension == 1 THEN
        Title: "Snoring and Blood Pressure Risk"
        Description: "Snoring together with high blood pressure may increase strain on your heart and blood vessels during sleep. This pattern is often seen in individuals with undiagnosed sleep apnea."
        Source: "American Heart Association (AHA); AASM – OSA and Cardiovascular Risk."
    ENDIF


    -- Snoring + High BMI --
    IF data.Snoring == 1 AND data.BMI >= 30 THEN
        Title: "Snoring and Weight-Related Airway Narrowing"
        Description: "Snoring combined with a higher BMI increases the likelihood that your upper airway becomes narrowed or collapses during sleep, contributing to louder snoring or breathing pauses."
        Source: "AASM – Obstructive Sleep Apnea Risk Factors; WHO – Obesity and Respiratory Function."
    ENDIF


    -- Snoring + High ESS --
    IF data.Snoring == 1 AND data.Epworth_Score >= 11 THEN
        Title: "Snoring and Excessive Daytime Sleepiness"
        Description: "Snoring plus significant daytime sleepiness suggests that your sleep may be fragmented or non-restorative, possibly due to repeated airway obstruction during the night."
        Source: "Epworth Sleepiness Scale (Johns, 1991); AASM – Snoring and Sleep Fragmentation."
    ENDIF


    -- High BMI + Large Neck Circumference --
    IF data.BMI >= 30 AND data.Neck_Circumference >= 40 THEN
        Title: "Body Habitus and Airway Structure"
        Description: "A combination of higher BMI and larger neck circumference is strongly associated with upper airway narrowing, which increases the risk of obstructed breathing during sleep."
        Source: "STOP-Bang Guidelines (Chung F. et al.); WHO – BMI and OSA."
    ENDIF


    -- Low Sleep Duration + High ESS --
    IF data.Sleep_Duration < 7 AND data.Epworth_Score >= 11 THEN
        Title: "Sleep Debt and Daytime Sleepiness"
        Description: "Short sleep combined with elevated daytime sleepiness suggests that you are accumulating sleep debt and your sleep is not fully restorative."
        Source: "CDC – Sleep Duration and Health; Epworth Sleepiness Scale (Johns, 1991)."
    ENDIF


    -- High STOP-Bang + Large Neck Circumference --
    IF data.STOPBANG_Total >= 5 AND data.Neck_Circumference >= 40 THEN
        Title: "High-Risk Screening and Neck Anatomy"
        Description: "Your screening score and neck circumference together suggest a high likelihood of airway narrowing during sleep, which is characteristic of obstructive sleep apnea."
        Source: "Chung F. et al., STOP-Bang Questionnaire Clinical Pathways."
    ENDIF


    -- Hypertension + Diabetes --
    IF data.Hypertension == 1 AND data.Diabetes == 1 THEN
        Title: "Metabolic and Blood Pressure Risks During Sleep"
        Description: "The combination of hypertension and diabetes is frequently seen in people with sleep-disordered breathing. Improving sleep quality can support overall cardiometabolic health."
        Source: "American Heart Association (AHA); American Diabetes Association (ADA)."
    ENDIF


    -- Alcohol + Snoring --
    IF data.Alcohol == 1 AND data.Snoring == 1 THEN
        Title: "Alcohol’s Effect on Snoring"
        Description: "Alcohol relaxes the muscles in the throat and can significantly worsen snoring intensity and frequency. Avoiding alcohol close to bedtime may reduce snoring."
        Source: "American Academy of Sleep Medicine (AASM) – Alcohol and Airway Tone."
    ENDIF


    -- Vigorous Exercise at Night --
    IF data.Activity_Type == "vigorous" AND data.Activity_Time == "night" THEN
        Title: "Vigorous Night Exercise and Sleep Onset"
        Description: "Doing vigorous exercise at night can increase heart rate and alertness, potentially delaying your ability to fall asleep, especially if your bedtime is soon after your workout."
        Source: "National Sleep Foundation – Evening and Nighttime Exercise Studies."
    ENDIF


    -- Low Activity Minutes + High ESS --
    IF data.Physical_Activity_Minutes < 30 AND data.Epworth_Score >= 11 THEN
        Title: "Low Movement and Daytime Sleepiness"
        Description: "Low daily physical activity combined with significant daytime sleepiness suggests you may benefit from gradually increasing your activity to support better sleep and alertness."
        Source: "CDC Physical Activity Guidelines; ESS Research on Fatigue."
    ENDIF


    -- Moderate Afternoon Exercise + Snoring --
    IF data.Activity_Type == "moderate" AND data.Activity_Time == "afternoon" AND data.Snoring == 1 THEN
        Title: "Moderate Afternoon Exercise and Snoring"
        Description: "Moderate exercise in the afternoon can help improve nighttime sleep efficiency and may indirectly support better airway muscle tone, which can help with snoring."
        Source: "AASM – Physical Activity and Sleep-Disordered Breathing."
    ENDIF


    -- Morning Exercise + High STOP-Bang --
    IF data.Activity_Time == "morning" AND data.STOPBANG_Total >= 5 THEN
        Title: "Morning Activity for High-Risk Sleep Patterns"
        Description: "With a higher STOP-Bang score, maintaining a consistent morning exercise routine can help stabilize your circadian rhythm and support better nighttime sleep."
        Source: "Sleep Foundation – Morning Exercise and Sleep-Wake Regulation; Chung F. et al., STOP-Bang Research."
    ENDIF


    -- High BMI + Low Physical Activity --
    IF data.BMI >= 30 AND data.Physical_Activity_Minutes < 30 THEN
        Title: "Weight and Inactivity Effects on Breathing"
        Description: "Higher body weight combined with low activity levels can contribute to reduced respiratory function and airway narrowing during sleep. Gradual increases in movement can be beneficial."
        Source: "World Health Organization (WHO); AASM – Weight, Activity, and OSA."
    ENDIF


    -- Evening Exercise + Short Sleep Duration --
    IF data.Activity_Time == "evening" AND data.Sleep_Duration < 7 THEN
        Title: "Adjusting Evening Exercise to Improve Sleep"
        Description: "Since you are sleeping less than 7 hours and often exercise in the evening, shifting some workouts earlier in the day may help you wind down more easily at night."
        Source: "Harvard Medical School – Division of Sleep Medicine, Exercise Timing and Sleep."
    ENDIF



    ==============================================================
    =           3. THREE-FACTOR (OR MORE) HIGH-RISK RULES        =
    ==============================================================

    -- Snoring + High BMI + High ESS --
    IF data.Snoring == 1 AND data.BMI >= 30 AND data.Epworth_Score >= 11 THEN
        Title: "Strong Pattern of Possible Sleep-Disordered Breathing"
        Description: "The combination of snoring, higher BMI, and significant daytime sleepiness strongly suggests fragmented or disrupted sleep, possibly due to repeated breathing interruptions at night."
        Source: "American Academy of Sleep Medicine (AASM); ESS Research (Johns, 1991)."
    ENDIF


    -- Large Neck + High BMI + High STOP-Bang --
    IF data.Neck_Circumference >= 40 AND data.BMI >= 30 AND data.STOPBANG_Total >= 5 THEN
        Title: "Multiple Anatomical and Screening Indicators of OSA"
        Description: "Your neck size, weight, and STOP-Bang score together indicate a high probability of obstructive sleep apnea. This pattern is commonly seen in individuals with significant airway narrowing during sleep."
        Source: "Chung F. et al., STOP-Bang Questionnaire Clinical Validation; WHO – Obesity and OSA."
    ENDIF


    -- Hypertension + Snoring + High ESS --
    IF data.Hypertension == 1 AND data.Snoring == 1 AND data.Epworth_Score >= 11 THEN
        Title: "Cardiovascular Strain from Poor Sleep"
        Description: "High blood pressure combined with snoring and daytime sleepiness may indicate that your heart and blood vessels are under extra strain during sleep, often seen in people with sleep apnea."
        Source: "American Heart Association (AHA); AASM – OSA and Cardiovascular Outcomes."
    ENDIF


    -- Short Sleep + High ESS + High STOP-Bang --
    IF data.Sleep_Duration < 7 AND data.Epworth_Score >= 11 AND data.STOPBANG_Total >= 5 THEN
        Title: "Sleep Debt and High Apnea Risk"
        Description: "Short sleep, significant daytime sleepiness, and a high STOP-Bang score together suggest that your sleep may be both insufficient and disrupted by breathing problems."
        Source: "CDC – Sleep Duration; Epworth Sleepiness Scale; Chung F. et al., STOP-Bang."
    ENDIF


    -- Diabetes + Hypertension + Snoring --
    IF data.Diabetes == 1 AND data.Hypertension == 1 AND data.Snoring == 1 THEN
        Title: "Metabolic, Blood Pressure, and Airway Red Flags"
        Description: "The combination of diabetes, hypertension, and snoring is frequently observed in individuals with underlying sleep apnea. Addressing sleep quality can be an important part of overall health management."
        Source: "American Heart Association (AHA); American Diabetes Association (ADA); AASM – Sleep and Cardiometabolic Health."
    ENDIF


    -- Low Activity + High BMI + Snoring --
    IF data.Physical_Activity_Minutes < 30 AND data.BMI >= 30 AND data.Snoring == 1 THEN
        Title: "Activity, Weight, and Breathing Difficulties"
        Description: "Low daily movement combined with higher BMI and snoring may indicate increased airway resistance and reduced respiratory fitness. Gradual increases in physical activity can help support better breathing and sleep."
        Source: "AASM – OSA and Lifestyle; WHO; CDC Physical Activity Guidelines."
    ENDIF


    -- Moderate Morning Exercise + High ESS + Short Sleep --
    IF data.Activity_Type == "moderate" AND data.Activity_Time == "morning" AND 
       data.Epworth_Score >= 11 AND data.Sleep_Duration < 7 THEN
        Title: "Strengthening Your Sleep-Wake Cycle"
        Description: "You already benefit from morning moderate exercise, but your high daytime sleepiness and short sleep duration suggest your sleep-wake cycle may still be disrupted. Extending sleep time and keeping a consistent schedule can help."
        Source: "Sleep Foundation – Morning Exercise; Epworth Sleepiness Scale; CDC – Sleep Duration."
    ENDIF


    -- Vigorous Night Exercise + High ESS --
    IF data.Activity_Type == "vigorous" AND data.Activity_Time == "night" AND data.Epworth_Score >= 11 THEN
        Title: "Nighttime Intensity and Next-Day Tiredness"
        Description: "Vigorous exercise late at night, combined with significant daytime sleepiness, suggests that your workouts might be too close to bedtime or disrupting your ability to wind down."
        Source: "National Sleep Foundation – Evening Exercise; ESS Research on Sleepiness."
    ENDIF


    -- High STOP-Bang + Low Activity + Hypertension --
    IF data.STOPBANG_Total >= 5 AND data.Physical_Activity_Minutes < 30 AND data.Hypertension == 1 THEN
        Title: "High-Risk Profile with Low Activity"
        Description: "A high STOP-Bang score, low physical activity, and hypertension together indicate an increased cardiometabolic and sleep-related risk profile. Improving activity levels and sleep quality may have meaningful health benefits."
        Source: "Chung F. et al., STOP-Bang; American Heart Association; CDC Physical Activity Guidelines."
    ENDIF


    RETURN recs

END FUNCTION

